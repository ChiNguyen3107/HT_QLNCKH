<!DOCTYPE html>
<html>
<head>
    <title>Test Student API</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>
    <h2>Test tìm kiếm thông tin sinh viên</h2>
    
    <div>
        <label>Nhập MSSV:</label>
        <input type="text" id="studentId" value="B2110051" placeholder="Nhập MSSV (8 ký tự)">
        <button onclick="searchStudent()">Tìm kiếm</button>
    </div>
    
    <div id="result" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>

    <script>
    function searchStudent() {
        const studentId = document.getElementById('studentId').value.trim();
        
        if (!studentId) {
            alert('Vui lòng nhập MSSV');
            return;
        }
        
        document.getElementById('result').innerHTML = 'Đang tìm kiếm...';
        
        $.ajax({
            url: '/NLNganh/get_student_info_test.php', // Sử dụng version test
            method: 'GET',
            data: { student_id: studentId },
            dataType: 'json',
            success: function(response) {
                console.log('Response:', response);
                
                if (response.success) {
                    const data = response.data;
                    document.getElementById('result').innerHTML = `
                        <h3>Thông tin sinh viên:</h3>
                        <p><strong>MSSV:</strong> ${data.SV_MASV}</p>
                        <p><strong>Họ tên:</strong> ${data.fullname}</p>
                        <p><strong>Ngày sinh:</strong> ${data.SV_NGAYSINH}</p>
                        <p><strong>SĐT:</strong> ${data.SV_SDT}</p>
                        <p><strong>Email:</strong> ${data.SV_EMAIL}</p>
                        <p><strong>Lớp:</strong> ${data.LOP_TEN}</p>
                        <p><strong>Khóa:</strong> ${data.KHOA}</p>
                    `;
                } else {
                    document.getElementById('result').innerHTML = `
                        <div style="color: red;">
                            <strong>Lỗi:</strong> ${response.message}
                        </div>
                    `;
                }
            },
            error: function(xhr, status, error) {
                console.error('AJAX Error:', {xhr, status, error});
                document.getElementById('result').innerHTML = `
                    <div style="color: red;">
                        <strong>Lỗi kết nối:</strong> ${error}<br>
                        <strong>Status:</strong> ${status}<br>
                        <strong>Response:</strong> ${xhr.responseText}
                    </div>
                `;
            }
        });
    }
    </script>
</body>
</html>
