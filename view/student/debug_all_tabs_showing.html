<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug All Tabs Showing Issue</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <style>
        .simple-pane {
            border: 3px solid red;
            margin: 10px 0;
            padding: 20px;
            background: #ffe6e6;
        }
        .simple-pane.active {
            border-color: green;
            background: #e6ffe6;
        }
        
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: white;
            border: 2px solid #333;
            padding: 15px;
            border-radius: 5px;
            z-index: 9999;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h3>Debug: All Tabs Showing Issue</h3>
        
        <div class="debug-panel">
            <h6>Live Debug Info:</h6>
            <div id="debugInfo">
                <div>Total Panes: <span id="totalPanes">0</span></div>
                <div>Visible Panes: <span id="visiblePanes">0</span></div>
                <div>Active Panes: <span id="activePanes">0</span></div>
                <div>Hidden Panes: <span id="hiddenPanes">0</span></div>
            </div>
            <button class="btn btn-sm btn-primary mt-2" onclick="updateDebugInfo()">Refresh</button>
            <button class="btn btn-sm btn-danger mt-2" onclick="forceHideAll()">Force Hide All</button>
        </div>
        
        <!-- Simple Nav tabs -->
        <ul class="nav nav-tabs mb-3">
            <li class="nav-item">
                <a class="nav-link active simple-tab" href="#proposal" data-tab="proposal">Thuy·∫øt minh</a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" href="#contract" data-tab="contract">H·ª£p ƒë·ªìng</a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" href="#decision" data-tab="decision">Quy·∫øt ƒë·ªãnh</a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" href="#report" data-tab="report">Bi√™n b·∫£n</a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" href="#evaluation" data-tab="evaluation">ƒê√°nh gi√°</a>
            </li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
            <div class="simple-pane active" id="proposal">
                <h5>üî¥ Thuy·∫øt minh (Should be hidden when not active)</h5>
                <p>N·ªôi dung thuy·∫øt minh...</p>
                <p><strong>Pane ID:</strong> proposal</p>
                <p><strong>Classes:</strong> <span class="pane-classes" data-pane="proposal"></span></p>
                <p><strong>CSS Display:</strong> <span class="pane-display" data-pane="proposal"></span></p>
            </div>
            <div class="simple-pane" id="contract">
                <h5>üî¥ H·ª£p ƒë·ªìng (Should be hidden when not active)</h5>
                <p>N·ªôi dung h·ª£p ƒë·ªìng...</p>
                <p><strong>Pane ID:</strong> contract</p>
                <p><strong>Classes:</strong> <span class="pane-classes" data-pane="contract"></span></p>
                <p><strong>CSS Display:</strong> <span class="pane-display" data-pane="contract"></span></p>
            </div>
            <div class="simple-pane" id="decision">
                <h5>üî¥ Quy·∫øt ƒë·ªãnh (Should be hidden when not active)</h5>
                <p>N·ªôi dung quy·∫øt ƒë·ªãnh...</p>
                <p><strong>Pane ID:</strong> decision</p>
                <p><strong>Classes:</strong> <span class="pane-classes" data-pane="decision"></span></p>
                <p><strong>CSS Display:</strong> <span class="pane-display" data-pane="decision"></span></p>
            </div>
            <div class="simple-pane" id="report">
                <h5>üî¥ Bi√™n b·∫£n (Should be hidden when not active)</h5>
                <p>N·ªôi dung bi√™n b·∫£n...</p>
                <p><strong>Pane ID:</strong> report</p>
                <p><strong>Classes:</strong> <span class="pane-classes" data-pane="report"></span></p>
                <p><strong>CSS Display:</strong> <span class="pane-display" data-pane="report"></span></p>
            </div>
            <div class="simple-pane" id="evaluation">
                <h5>üî¥ ƒê√°nh gi√° (Should be hidden when not active)</h5>
                <p>N·ªôi dung ƒë√°nh gi√°...</p>
                <p><strong>Pane ID:</strong> evaluation</p>
                <p><strong>Classes:</strong> <span class="pane-classes" data-pane="evaluation"></span></p>
                <p><strong>CSS Display:</strong> <span class="pane-display" data-pane="evaluation"></span></p>
            </div>
        </div>
        
        <div class="mt-4">
            <h5>Manual Debug Controls:</h5>
            <button class="btn btn-warning btn-sm" onclick="activateSimpleTab('proposal')">Show Proposal</button>
            <button class="btn btn-warning btn-sm" onclick="activateSimpleTab('contract')">Show Contract</button>
            <button class="btn btn-warning btn-sm" onclick="activateSimpleTab('report')">Show Report</button>
            <button class="btn btn-danger btn-sm" onclick="showAllPanes()">Show All (Debug)</button>
            <button class="btn btn-success btn-sm" onclick="hideAllPanes()">Hide All</button>
        </div>
        
        <div class="mt-4">
            <h5>Console Logs:</h5>
            <div id="consoleLogs" style="background: #f8f9fa; padding: 10px; border-radius: 5px; max-height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px;"></div>
        </div>
    </div>

    <script>
        // Override console.log to show in page
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const logDiv = $('#consoleLogs');
            logDiv.append('<div>' + args.join(' ') + '</div>');
            logDiv.scrollTop(logDiv[0].scrollHeight);
        };
        
        $(document).ready(function() {
            console.log('=== DEBUG PAGE LOADED ===');
            updateDebugInfo();
            initSimpleTabs();
            
            // Update debug info every 2 seconds
            setInterval(updateDebugInfo, 2000);
        });

        function updateDebugInfo() {
            $('#totalPanes').text($('.simple-pane').length);
            $('#visiblePanes').text($('.simple-pane:visible').length);
            $('#activePanes').text($('.simple-pane.active').length);
            $('#hiddenPanes').text($('.simple-pane:hidden').length);
            
            // Update individual pane info
            $('.simple-pane').each(function() {
                const id = this.id;
                $('.pane-classes[data-pane="' + id + '"]').text(this.className);
                $('.pane-display[data-pane="' + id + '"]').text($(this).css('display'));
            });
        }

        function initSimpleTabs() {
            console.log('=== INITIALIZING SIMPLE TABS ===');
            
            // FORCE CSS
            $('<style id="simple-tabs-css">.simple-pane { display: none !important; } .simple-pane.active { display: block !important; }</style>').appendTo('head');
            
            var tabLinks = $('.simple-tab');
            var tabPanes = $('.simple-pane');
            
            console.log('Tab links:', tabLinks.length);
            console.log('Tab panes:', tabPanes.length);
            
            // Hide all panes with multiple methods
            tabPanes.each(function() {
                $(this).removeClass('active');
                $(this).hide();
                $(this).css({
                    'display': 'none',
                    'visibility': 'hidden'
                });
                console.log('Hiding pane:', this.id);
            });
            
            // Get target tab
            var urlParams = new URLSearchParams(window.location.search);
            var targetTab = urlParams.get('tab') || 'proposal';
            
            console.log('Target tab:', targetTab);
            
            // Activate correct tab
            activateSimpleTab(targetTab);
            
            // Handle clicks
            tabLinks.off('click').on('click', function(e) {
                e.preventDefault();
                var tabName = $(this).data('tab');
                console.log('Tab clicked:', tabName);
                activateSimpleTab(tabName);
                updateDebugInfo();
            });
            
            console.log('=== SIMPLE TAB INITIALIZATION COMPLETE ===');
        }
        
        function activateSimpleTab(tabName) {
            console.log('Activating tab:', tabName);
            
            // FORCE hide all panes
            $('.simple-pane').each(function() {
                $(this).removeClass('active');
                $(this).hide();
                $(this).css({
                    'display': 'none',
                    'visibility': 'hidden'
                });
                console.log('Hiding pane:', this.id);
            });
            
            $('.simple-tab').removeClass('active');
            
            // Show target
            var targetPane = $('#' + tabName);
            var targetTab = $('.simple-tab[data-tab="' + tabName + '"]');
            
            if (targetPane.length > 0) {
                targetPane.addClass('active');
                targetPane.show();
                targetPane.css({
                    'display': 'block',
                    'visibility': 'visible'
                });
                targetTab.addClass('active');
                
                console.log('Tab activated:', tabName);
                console.log('Pane visible:', targetPane.is(':visible'));
                console.log('Pane display CSS:', targetPane.css('display'));
                
                // Double check - hide all others
                $('.simple-pane').not('#' + tabName).each(function() {
                    $(this).hide().css({
                        'display': 'none',
                        'visibility': 'hidden'
                    });
                });
            } else {
                console.log('Tab not found:', tabName);
            }
            
            updateDebugInfo();
        }
        
        function forceHideAll() {
            console.log('=== FORCE HIDING ALL PANES ===');
            $('.simple-pane').each(function() {
                $(this).removeClass('active');
                $(this).hide();
                $(this).css({
                    'display': 'none !important',
                    'visibility': 'hidden !important'
                });
                this.style.setProperty('display', 'none', 'important');
                console.log('Force hiding:', this.id);
            });
            updateDebugInfo();
        }
        
        function showAllPanes() {
            $('.simple-pane').show().css('display', 'block').css('visibility', 'visible');
            updateDebugInfo();
        }
        
        function hideAllPanes() {
            $('.simple-pane').hide().css('display', 'none').css('visibility', 'hidden');
            updateDebugInfo();
        }
    </script>
</body>
</html>
