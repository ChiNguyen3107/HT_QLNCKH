<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Tab Issue</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>
    <div class="container mt-4">
        <h3>Debug Tab - Ki·ªÉm tra v·∫•n ƒë·ªÅ content kh√¥ng thay th·∫ø</h3>
        
        <div class="alert alert-warning">
            <strong>M√¥ t·∫£ v·∫•n ƒë·ªÅ:</strong> "khi t√¥i b·∫•m v√†o tab th√¨ chuy·ªÉn ƒë·∫øn n·ªôi dung c·ªßa tab ƒë√≥ nh∆∞ng c√°c tab kh√°c kh√¥ng b·ªã ·∫©n ƒëi"
        </div>

        <!-- Navigation Buttons -->
        <div class="nav-buttons mb-4">
            <button class="btn btn-outline-primary tab-btn active" data-tab="tab1">
                Tab 1 - Red Content
            </button>
            <button class="btn btn-outline-primary tab-btn" data-tab="tab2">
                Tab 2 - Blue Content
            </button>
            <button class="btn btn-outline-primary tab-btn" data-tab="tab3">
                Tab 3 - Green Content
            </button>
        </div>

        <!-- Debug Info Panel -->
        <div class="row mb-3">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">Debug Information</div>
                    <div class="card-body">
                        <div id="debugInfo">
                            <p><strong>Current Active Tab:</strong> <span id="currentTab">tab1</span></p>
                            <p><strong>Content Area Children Count:</strong> <span id="childrenCount">0</span></p>
                            <p><strong>Content Area HTML Length:</strong> <span id="htmlLength">0</span></p>
                            <p><strong>Active Button:</strong> <span id="activeButton">none</span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">Manual Tests</div>
                    <div class="card-body">
                        <button class="btn btn-sm btn-info" onclick="clearContent()">Clear Content</button>
                        <button class="btn btn-sm btn-warning" onclick="showAllContent()">Show Raw HTML</button>
                        <button class="btn btn-sm btn-success" onclick="forceTab1()">Force Tab 1</button>
                        <button class="btn btn-sm btn-danger" onclick="inspectDOM()">Inspect DOM</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Single Content Area -->
        <div class="tab-container">
            <h5>Content Area (Should show ONLY one tab content):</h5>
            <div id="tab-content-area" style="border: 3px solid #000; padding: 20px; min-height: 200px;">
                <!-- Content will be loaded here -->
            </div>
        </div>
        
        <div class="mt-3">
            <div class="card">
                <div class="card-header">Console Log</div>
                <div class="card-body">
                    <div id="consoleLog" style="background: #f8f9fa; padding: 10px; height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px;"></div>
                </div>
            </div>
        </div>
    </div>

    <style>
        .tab-btn.active {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .content-red { background-color: #ffebee; border: 2px solid #f44336; padding: 20px; }
        .content-blue { background-color: #e3f2fd; border: 2px solid #2196f3; padding: 20px; }
        .content-green { background-color: #e8f5e8; border: 2px solid #4caf50; padding: 20px; }
    </style>

    <script>
        let logMessages = [];
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}`;
            logMessages.push(logMessage);
            console.log(logMessage);
            
            $('#consoleLog').append(logMessage + '\n');
            $('#consoleLog').scrollTop($('#consoleLog')[0].scrollHeight);
        }

        // Tab content templates v·ªõi m√†u s·∫Øc r√µ r√†ng
        const tabContents = {
            tab1: `
                <div class="content-red">
                    <h4 style="color: #d32f2f;">üî¥ TAB 1 - RED CONTENT</h4>
                    <p>ƒê√¢y l√† n·ªôi dung c·ªßa Tab 1 - m√†u ƒë·ªè</p>
                    <div class="alert alert-danger">
                        <strong>Tab 1 Active!</strong> N·∫øu b·∫°n th·∫•y content kh√°c c√πng l√∫c th√¨ c√≥ l·ªói!
                    </div>
                    <ul>
                        <li>Content 1 Line 1</li>
                        <li>Content 1 Line 2</li>
                        <li>Content 1 Line 3</li>
                    </ul>
                </div>
            `,
            tab2: `
                <div class="content-blue">
                    <h4 style="color: #1976d2;">üîµ TAB 2 - BLUE CONTENT</h4>
                    <p>ƒê√¢y l√† n·ªôi dung c·ªßa Tab 2 - m√†u xanh d∆∞∆°ng</p>
                    <div class="alert alert-primary">
                        <strong>Tab 2 Active!</strong> Content Tab 1 ph·∫£i bi·∫øn m·∫•t!
                    </div>
                    <div class="row">
                        <div class="col-md-6">Column 1</div>
                        <div class="col-md-6">Column 2</div>
                    </div>
                </div>
            `,
            tab3: `
                <div class="content-green">
                    <h4 style="color: #388e3c;">üü¢ TAB 3 - GREEN CONTENT</h4>
                    <p>ƒê√¢y l√† n·ªôi dung c·ªßa Tab 3 - m√†u xanh l√°</p>
                    <div class="alert alert-success">
                        <strong>Tab 3 Active!</strong> Ch·ªâ n·ªôi dung n√†y ƒë∆∞·ª£c hi·ªÉn th·ªã!
                    </div>
                    <table class="table table-sm">
                        <tr><td>Row 1</td><td>Data 1</td></tr>
                        <tr><td>Row 2</td><td>Data 2</td></tr>
                    </table>
                </div>
            `
        };
        
        let currentTab = 'tab1';
        
        $(document).ready(function() {
            log('=== PAGE LOADED ===');
            
            // Load initial content
            switchToTab('tab1');
            
            // Handle button clicks
            $('.tab-btn').click(function() {
                const tabName = $(this).data('tab');
                log(`Button clicked for tab: ${tabName}`);
                switchToTab(tabName);
            });
            
            // Update debug info every second
            setInterval(updateDebugInfo, 1000);
        });
        
        function switchToTab(tabName) {
            log(`--- SWITCHING TO TAB: ${tabName} ---`);
            
            if (!tabContents[tabName]) {
                log(`ERROR: Tab content not found for: ${tabName}`);
                return;
            }
            
            // 1. Update button states
            $('.tab-btn').removeClass('active');
            $('.tab-btn[data-tab="' + tabName + '"]').addClass('active');
            log(`Button active state updated for: ${tabName}`);
            
            // 2. Get content area
            const contentArea = $('#tab-content-area');
            log(`Content area found: ${contentArea.length > 0}`);
            
            // 3. CLEAR and REPLACE content
            log(`Before replace - HTML length: ${contentArea.html().length}`);
            contentArea.empty(); // Clear first
            log(`After empty - HTML length: ${contentArea.html().length}`);
            
            contentArea.html(tabContents[tabName]); // Then set new content
            log(`After html() - HTML length: ${contentArea.html().length}`);
            
            // 4. Update current tab
            currentTab = tabName;
            $('#currentTab').text(tabName);
            
            log(`--- TAB SWITCH COMPLETED: ${tabName} ---`);
            updateDebugInfo();
        }
        
        function updateDebugInfo() {
            const contentArea = $('#tab-content-area');
            const childrenCount = contentArea.children().length;
            const htmlLength = contentArea.html().length;
            const activeButton = $('.tab-btn.active').data('tab') || 'none';
            
            $('#childrenCount').text(childrenCount);
            $('#htmlLength').text(htmlLength);
            $('#activeButton').text(activeButton);
            
            // Check for multiple content divs
            const redCount = $('.content-red').length;
            const blueCount = $('.content-blue').length;
            const greenCount = $('.content-green').length;
            
            if (redCount + blueCount + greenCount > 1) {
                log(`‚ö†Ô∏è WARNING: Multiple contents detected! Red:${redCount}, Blue:${blueCount}, Green:${greenCount}`);
            }
        }
        
        function clearContent() {
            $('#tab-content-area').empty();
            log('Content area cleared manually');
        }
        
        function showAllContent() {
            const html = $('#tab-content-area').html();
            alert('Raw HTML:\n' + html.substring(0, 500) + (html.length > 500 ? '...' : ''));
        }
        
        function forceTab1() {
            log('=== FORCE TAB 1 TEST ===');
            switchToTab('tab1');
        }
        
        function inspectDOM() {
            const contentArea = $('#tab-content-area');
            const children = contentArea.children();
            
            log('=== DOM INSPECTION ===');
            log(`Content area children count: ${children.length}`);
            
            children.each(function(index) {
                const classes = $(this).attr('class') || 'no-class';
                const tagName = $(this).prop('tagName');
                log(`Child ${index}: <${tagName}> class="${classes}"`);
            });
        }
    </script>
</body>
</html>
