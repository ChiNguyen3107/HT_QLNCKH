<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Simple Tabs - Hide/Show Test</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <style>
        /* Force hide/show */
        .simple-pane {
            display: none !important;
            border: 2px solid red;
            margin: 10px 0;
            padding: 20px;
        }
        .simple-pane.active {
            display: block !important;
            border-color: green;
        }
        
        .debug-info {
            background: #f8f9fa;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h3>Debug Simple Tabs - Hide/Show Test</h3>
        
        <div class="debug-info">
            <h5>Debug Info:</h5>
            <p>Current URL: <span id="currentUrl"></span></p>
            <p>Tab Parameter: <span id="tabParam"></span></p>
            <p>All Panes: <span id="allPanes"></span></p>
            <p>Visible Panes: <span id="visiblePanes"></span></p>
            <p>Active Panes: <span id="activePanes"></span></p>
        </div>
        
        <!-- Simple Nav tabs -->
        <ul class="nav nav-tabs mb-3">
            <li class="nav-item">
                <a class="nav-link active simple-tab" href="#proposal" data-tab="proposal">Thuyết minh</a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" href="#contract" data-tab="contract">Hợp đồng</a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" href="#report" data-tab="report">Biên bản</a>
            </li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
            <div class="simple-pane active" id="proposal">
                <h5>Thuyết minh (Proposal)</h5>
                <p>Nội dung thuyết minh...</p>
                <p>Pane ID: proposal</p>
            </div>
            <div class="simple-pane" id="contract">
                <h5>Hợp đồng (Contract)</h5>
                <p>Nội dung hợp đồng...</p>
                <p>Pane ID: contract</p>
            </div>
            <div class="simple-pane" id="report">
                <h5>Biên bản (Report)</h5>
                <p>Nội dung biên bản...</p>
                <p>Pane ID: report</p>
                <a href="?tab=report" class="btn btn-primary">Test Redirect to Report</a>
            </div>
        </div>
        
        <div class="mt-4">
            <button class="btn btn-info btn-sm" onclick="updateDebugInfo()">Update Debug Info</button>
            <button class="btn btn-warning btn-sm" onclick="activateSimpleTab('report')">Force Report Tab</button>
            <button class="btn btn-success btn-sm" onclick="showAllPanes()">Show All Panes (Debug)</button>
            <button class="btn btn-danger btn-sm" onclick="hideAllPanes()">Hide All Panes</button>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            console.log('=== DEBUG PAGE LOADED ===');
            updateDebugInfo();
            initSimpleTabs();
        });

        function updateDebugInfo() {
            $('#currentUrl').text(window.location.href);
            $('#tabParam').text(new URLSearchParams(window.location.search).get('tab') || 'none');
            $('#allPanes').text($('.simple-pane').length);
            $('#visiblePanes').text($('.simple-pane:visible').length);
            $('#activePanes').text($('.simple-pane.active').length);
        }

        function initSimpleTabs() {
            console.log('=== INITIALIZING SIMPLE TABS ===');
            
            // Force CSS
            $('<style>.simple-pane { display: none !important; } .simple-pane.active { display: block !important; }</style>').appendTo('head');
            
            var tabLinks = $('.simple-tab');
            var tabPanes = $('.simple-pane');
            
            console.log('Tab links:', tabLinks.length);
            console.log('Tab panes:', tabPanes.length);
            
            // Hide all panes first
            tabPanes.removeClass('active').hide();
            
            // Get target tab
            var urlParams = new URLSearchParams(window.location.search);
            var targetTab = urlParams.get('tab') || 'proposal';
            
            console.log('Target tab:', targetTab);
            
            // Activate correct tab
            activateSimpleTab(targetTab);
            
            // Handle clicks
            tabLinks.off('click').on('click', function(e) {
                e.preventDefault();
                var tabName = $(this).data('tab');
                console.log('Tab clicked:', tabName);
                activateSimpleTab(tabName);
                updateDebugInfo();
            });
        }
        
        function activateSimpleTab(tabName) {
            console.log('Activating tab:', tabName);
            
            // Hide all
            $('.simple-pane').removeClass('active').hide();
            $('.simple-tab').removeClass('active');
            
            // Show target
            var targetPane = $('#' + tabName);
            var targetTab = $('.simple-tab[data-tab="' + tabName + '"]');
            
            if (targetPane.length > 0) {
                targetPane.addClass('active').show();
                targetTab.addClass('active');
                console.log('Tab activated:', tabName);
                console.log('Pane visible:', targetPane.is(':visible'));
            } else {
                console.log('Tab not found:', tabName);
            }
            
            updateDebugInfo();
        }
        
        function showAllPanes() {
            $('.simple-pane').show().addClass('active');
            updateDebugInfo();
        }
        
        function hideAllPanes() {
            $('.simple-pane').hide().removeClass('active');
            updateDebugInfo();
        }
    </script>
</body>
</html>
