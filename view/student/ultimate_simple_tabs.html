<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Simple Tabs Test</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- Không load Bootstrap JS để tránh conflicts -->
</head>
<body>
    <div class="container mt-4">
        <h3>Ultimate Simple Tabs - No Bootstrap JS</h3>
        <p>Current URL: <span id="currentUrl"></span></p>
        <p>Tab Parameter: <span id="tabParam"></span></p>
        
        <!-- Simple Nav tabs - KHÔNG có Bootstrap tab attributes -->
        <ul class="nav nav-tabs mb-3" id="documentTabs">
            <li class="nav-item">
                <a class="nav-link active simple-tab" id="proposal-tab" href="#proposal" data-tab="proposal">
                    Thuyết minh
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" id="contract-tab" href="#contract" data-tab="contract">
                    Hợp đồng
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" id="decision-tab" href="#decision" data-tab="decision">
                    Quyết định
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" id="report-tab" href="#report" data-tab="report">
                    Biên bản
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link simple-tab" id="evaluation-tab" href="#evaluation" data-tab="evaluation">
                    Đánh giá
                </a>
            </li>
        </ul>

        <!-- Tab panes - KHÔNG có Bootstrap tab classes -->
        <div class="tab-content" id="documentTabsContent">
            <div class="simple-pane active" id="proposal">
                <div class="card">
                    <div class="card-body">
                        <h5>Thuyết minh</h5>
                        <p>Nội dung thuyết minh...</p>
                    </div>
                </div>
            </div>
            <div class="simple-pane" id="contract">
                <div class="card">
                    <div class="card-body">
                        <h5>Hợp đồng</h5>
                        <p>Nội dung hợp đồng...</p>
                    </div>
                </div>
            </div>
            <div class="simple-pane" id="decision">
                <div class="card">
                    <div class="card-body">
                        <h5>Quyết định</h5>
                        <p>Nội dung quyết định...</p>
                    </div>
                </div>
            </div>
            <div class="simple-pane" id="report">
                <div class="card">
                    <div class="card-body">
                        <h5>Biên bản</h5>
                        <p>Nội dung biên bản...</p>
                        <a href="?tab=report" class="btn btn-primary">Test Redirect to Report</a>
                    </div>
                </div>
            </div>
            <div class="simple-pane" id="evaluation">
                <div class="card">
                    <div class="card-body">
                        <h5>Đánh giá</h5>
                        <p>Nội dung đánh giá...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <h5>Debug Controls:</h5>
            <button class="btn btn-info btn-sm" onclick="showStatus()">Show Status</button>
            <button class="btn btn-warning btn-sm" onclick="activateTab('report')">Force Report Tab</button>
            <button class="btn btn-success btn-sm" onclick="testUrlChange()">Test URL ?tab=report</button>
            <div id="debugInfo" class="mt-2"></div>
        </div>
    </div>

    <style>
        .simple-pane {
            display: none;
        }
        .simple-pane.active {
            display: block;
        }
    </style>

    <script>
        console.log('=== SIMPLE TAB PAGE LOADED ===');
        
        $(document).ready(function() {
            console.log('=== DOCUMENT READY ===');
            updateUrlInfo();
            initSimpleTabs();
        });

        function updateUrlInfo() {
            $('#currentUrl').text(window.location.href);
            $('#tabParam').text(new URLSearchParams(window.location.search).get('tab') || 'none');
        }

        function initSimpleTabs() {
            console.log('=== INITIALIZING SIMPLE TABS ===');
            
            // Get target tab from URL
            var urlParams = new URLSearchParams(window.location.search);
            var targetTab = urlParams.get('tab') || 'proposal';
            
            console.log('Target tab:', targetTab);
            
            // Activate the correct tab
            activateTab(targetTab);
            
            // Handle clicks
            $('.simple-tab').off('click').on('click', function(e) {
                e.preventDefault();
                var tabName = $(this).data('tab');
                console.log('Tab clicked:', tabName);
                activateTab(tabName);
                updateUrl(tabName);
            });
            
            console.log('=== SIMPLE TAB INITIALIZATION COMPLETE ===');
        }
        
        function activateTab(tabName) {
            console.log('Activating tab:', tabName);
            
            // Remove all active classes
            $('.simple-tab').removeClass('active');
            $('.simple-pane').removeClass('active');
            
            // Add active to correct elements
            $('.simple-tab[data-tab="' + tabName + '"]').addClass('active');
            $('#' + tabName).addClass('active');
            
            // Store in session
            sessionStorage.setItem('activeTab', tabName);
            
            console.log('Tab activated:', tabName);
        }
        
        function updateUrl(tabName) {
            if (history.pushState) {
                var newUrl = window.location.pathname + '?tab=' + tabName;
                history.pushState(null, null, newUrl);
                updateUrlInfo();
                console.log('URL updated to:', newUrl);
            }
        }
        
        function showStatus() {
            var info = '';
            info += 'Active tab link: ' + $('.simple-tab.active').length + '<br>';
            info += 'Active tab pane: ' + $('.simple-pane.active').length + '<br>';
            info += 'Current active tab: ' + $('.simple-tab.active').data('tab') + '<br>';
            info += 'Current URL: ' + window.location.href + '<br>';
            info += 'URL tab parameter: ' + new URLSearchParams(window.location.search).get('tab') + '<br>';
            info += 'Session storage: ' + sessionStorage.getItem('activeTab') + '<br>';
            $('#debugInfo').html(info);
        }
        
        function testUrlChange() {
            window.location.href = window.location.pathname + '?tab=report';
        }
    </script>
</body>
</html>
