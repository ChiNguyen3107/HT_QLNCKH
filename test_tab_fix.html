<!DOCTYPE html>
<html>
<head>
    <title>Test Tab Issue Fix</title>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .nav-tab { padding: 10px; margin: 5px; border: 1px solid #ccc; cursor: pointer; }
        .nav-tab.active { background: #007cba; color: white; }
    </style>
</head>
<body>
    <h1>Test Tab Functionality</h1>
    
    <h2>Simulating Problem Data (DT0000003)</h2>
    
    <!-- Test OLD version (broken) -->
    <h3>OLD Version (Should Break):</h3>
    <div id="old-test">
        <div class="nav-tabs">
            <div class="nav-tab active" data-target="tab1">Tab 1</div>
            <div class="nav-tab" data-target="tab2">Tab 2</div>
            <div class="nav-tab" data-target="tab3">Tab 3</div>
        </div>
        
        <!-- PROBLEMATIC: Multi-line input (simulating old bug) -->
        <input type="hidden" id="council_members_old" value="Huỳnh Thanh Phong (Chủ tịch)
Lê Minh Tuấn (Phó chủ tịch)
Nguyễn Thị Hoa (Thư ký)
Trần Văn Bình (Thành viên)">
        
        <div class="tab-content active" id="tab1">Content 1</div>
        <div class="tab-content" id="tab2">Content 2</div>
        <div class="tab-content" id="tab3">Content 3</div>
        
        <div id="old-result"></div>
    </div>
    
    <!-- Test NEW version (fixed) -->
    <h3>NEW Version (Should Work):</h3>
    <div id="new-test">
        <div class="nav-tabs">
            <div class="nav-tab active" data-target="tab4">Tab 1</div>
            <div class="nav-tab" data-target="tab5">Tab 2</div>
            <div class="nav-tab" data-target="tab6">Tab 3</div>
        </div>
        
        <!-- FIXED: Single-line input -->
        <input type="hidden" id="council_members_new" value="Huỳnh Thanh Phong (Chủ tịch) Lê Minh Tuấn (Phó chủ tịch) Nguyễn Thị Hoa (Thư ký) Trần Văn Bình (Thành viên)">
        
        <div class="tab-content active" id="tab4">Content 1</div>
        <div class="tab-content" id="tab5">Content 2</div>
        <div class="tab-content" id="tab6">Content 3</div>
        
        <div id="new-result"></div>
    </div>

    <script>
        // Test OLD version
        try {
            document.querySelectorAll('#old-test .nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // Clear active
                    document.querySelectorAll('#old-test .nav-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('#old-test .tab-content').forEach(t => t.classList.remove('active'));
                    
                    // Set active
                    this.classList.add('active');
                    document.getElementById(this.dataset.target).classList.add('active');
                });
            });
            
            document.getElementById('old-result').innerHTML = '<span style="color: green;">✅ OLD: Surprisingly works (maybe browser auto-fixes HTML)</span>';
        } catch (e) {
            document.getElementById('old-result').innerHTML = '<span style="color: red;">❌ OLD: Error - ' + e.message + '</span>';
        }
        
        // Test NEW version
        try {
            document.querySelectorAll('#new-test .nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // Clear active
                    document.querySelectorAll('#new-test .nav-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('#new-test .tab-content').forEach(t => t.classList.remove('active'));
                    
                    // Set active
                    this.classList.add('active');
                    document.getElementById(this.dataset.target).classList.add('active');
                });
            });
            
            document.getElementById('new-result').innerHTML = '<span style="color: green;">✅ NEW: Works correctly</span>';
        } catch (e) {
            document.getElementById('new-result').innerHTML = '<span style="color: red;">❌ NEW: Error - ' + e.message + '</span>';
        }
        
        // Check HTML structure
        console.log('OLD input HTML:', document.getElementById('council_members_old').outerHTML);
        console.log('NEW input HTML:', document.getElementById('council_members_new').outerHTML);
        
        // Test accessing values
        try {
            const oldValue = document.getElementById('council_members_old').value;
            const newValue = document.getElementById('council_members_new').value;
            
            console.log('OLD value length:', oldValue.length);
            console.log('NEW value length:', newValue.length);
            console.log('OLD has newlines:', oldValue.indexOf('\n') !== -1);
            console.log('NEW has newlines:', newValue.indexOf('\n') !== -1);
        } catch (e) {
            console.error('Error accessing values:', e);
        }
    </script>
</body>
</html>
